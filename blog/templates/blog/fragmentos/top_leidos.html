<!-- COMPONENTE REUTILIZABLE: Top 5 mÃ¡s leÃ­dos -->
<aside class="bloque-populares">
  <h3>ğŸ”¥ Top 5 mÃ¡s leÃ­dos</h3>
  <ul>
    {% for post in populares %}
      <li class="top-leidos-item">
        <a href="{{ post.get_absolute_url }}" class="top-leidos-link">
      <span class="top-leidos-icono">ğŸ”¹</span> {{ post.titulo }}
        </a>
      <span class="contador" data-visitas="{{ post.visitas }}">0 visitas</span>
      </li>
    {% endfor %}

  </ul>
</aside>



<!-- ğŸ§  MASCOTA FLOTANTE: BÃšHO INSPIRADOR -->
<div id="buho-mascota" onclick="hablaBuho()">
  ğŸ¦‰
</div>
<div id="frase-buho" hidden></div>

<script>
function hablaBuho() {
  const categoria = document.body.getAttribute('data-categoria') || 'all';

  const frasesPorCategoria = {
    python: [
      "ğŸ 'Lo explÃ­cito es mejor que lo implÃ­cito.' â€” Zen de Python",
      "ğŸ’¡ 'Aprende Python como si fueras a enseÃ±arlo.'"
    ],
    js: [
      "ğŸ’¥ 'JS puede todo... pero no deberÃ­a.'",
      "ğŸ”§ 'undefined no es un error, es una advertencia.'"
    ],
    react: [
      "âš›ï¸ 'Piensa en componentes, no en pÃ¡ginas.'",
      "ğŸ” 'Usa el estado con respeto. Te devolverÃ¡ la armonÃ­a.'"
    ],
    css: [
      "ğŸ¨ 'El diseÃ±o no es cÃ³mo se ve, sino cÃ³mo funciona.' â€” Steve Jobs",
      "ğŸ§© 'CSS es el arte de organizar lo que otros rompen.'"
    ],
    docker: [
      "ğŸ³ 'Crea. AÃ­sla. Ejecuta. Repite.'",
      "âš™ï¸ 'Si funciona en mi mÃ¡quina... haz un contenedor.'"
    ],
    all: [
      "ğŸ¦‰ 'Haz preguntas, el cÃ³digo te responde.'",
      "ğŸŒ± 'El aprendizaje constante es la mayor inversiÃ³n.'"
    ]
  };

  const frases = frasesPorCategoria[categoria] || frasesPorCategoria['all'];
  const frase = frases[Math.floor(Math.random() * frases.length)];

  const div = document.getElementById('frase-buho');
  div.innerText = 'ğŸ’¬ ' + frase;
  div.hidden = false;
}


  document.addEventListener('DOMContentLoaded', function () {
    const counters = document.querySelectorAll('.contador');
    counters.forEach(counter => {
      const visitas = +counter.getAttribute('data-visitas');
      let count = 0;
      const increment = Math.max(1, Math.ceil(visitas / 60));

      const updateCount = () => {
        count += increment;
        if (count >= visitas) {
          count = visitas;
          counter.childNodes[0].textContent = `ğŸ‘ï¸ ${count} visitas`;
          counter.classList.add('contador-final');

          const frase = document.createElement('div');
          frase.classList.add('frase-papamoscas');
          frase.innerText = obtenerFraseAleatoria();
          counter.appendChild(frase);

          const mascota = counter.querySelector('.papamoscas');
          if (mascota) {
            mascota.hidden = false;
            mascota.classList.add('papamoscas-animado');
          }
        } else {
          counter.childNodes[0].textContent = `ğŸ‘ï¸ ${count} visitas`;
          requestAnimationFrame(updateCount);
        }
      };

      updateCount();
    });

    function obtenerFraseAleatoria() {
      const frases = [
        'Â¡Esto empieza a moverse!',
        'ğŸ‘€ Yo de ti irÃ­a actualizando...',
        'ğŸ”” Â¡Ya te estÃ¡n leyendo!',
        'ğŸ“ˆ Esto sube que sube...',
        'ğŸ¦‰ El bÃºho lo ha visto todo...'
      ];
      return frases[Math.floor(Math.random() * frases.length)];
    }
  });
</script>

